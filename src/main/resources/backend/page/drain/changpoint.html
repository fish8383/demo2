<!DOCTYPE html><html><head>    <!-- 页面meta -->    <meta charset="utf-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <title>webSocket</title>    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">    <!-- 引入样式 --></head><body class="hold-transition"><div id="app">    <!--    <div class="content-header">-->    <h1>输送数据采集</h1></div><script>    const Socket = new WebSocket("ws://172.22.35.197/ws/emosweb");    let params = new Array();    let i = 1;    params[i++] = {"type": "general", "key": "userActivityStatues", "value": "ACTIVE"};    params[i++] = {"id": "", "type": "advise", "plc": "L3F07", "tag": ".L3F07_DecPoint_TC400.Row[1,2].AS.I9999_Dest"};    params[i++] = {        "id": "12",        "type": "poke",        "plc": "L3F07",        "tag": ".L3F07_DecPoint_TC400.Row[1,2].AS.I9999_Filtr03",        "value": "this.color1"    };    params[i++] = {        "id": "",        "type": "advise",        "plc": "L3F07",        "tag": ".L3F07_DecPoint_TC400.Row[1,2].AS.I9999_Filtr03"    };    params[i++] = {"id": "", "type": "advise", "plc": "L3F07", "tag": ".L3F07_DecPoint_TC400.SB.S9999_Start"};   let  color1;    // alert(window.color1)    let liveParam = {type: "info", info: "alive"};    liveParam = JSON.stringify(liveParam);    for (let i = 0; i < params.length; i++) {        params[i] = JSON.stringify(params[i])    }    Socket.onopen = function () {        this.params = params;        for (let i = 0; i < params.length; i++) {            Socket.send(this.params[i]);        }        console.log("ws open...");    };    Socket.onmessage = function (evt) {        var object = JSON.parse(evt.data)    };    Socket.onclose = function (evt) {        window.alert("WebSocketClosed!")        console.log("WebSocketClosed!");        Socket.close();    };    Socket.onerror = function (evt) {        console.log("WebSocketError!");    };    var x = 0;    setInterval(function () {        if (x % 2 == 0) {            Socket.send(liveParam);            window.location.reload();        } else {            console.log(x);        }        x++;    }, 60000)</script></body><!-- 引入组件库 --><!-- 开发环境版本，包含了有帮助的命令行警告 --><script src="../../plugins/vue/vue.js"></script><!-- 引入组件库 --><script src="../../plugins/element-ui/index.js"></script><!-- 引入axios --><script src="../../plugins/axios/axios.min.js"></script><script>    var vue = new Vue({        el: '#app',        data: {            color1:String,            color2: String,            pagination: {},            dataList: [],//当前页要展示的列表数据            formData: {},//表单数据            dialogFormVisible: false,//控制表单是否可见            dialogFormVisible4Edit: false,//编辑表单是否可见            rules: {//校验规则                type: [{required: true, message: '类别为必填项', trigger: 'blur'}],                name: [{required: true, message: '名称为必填项', trigger: 'blur'}]            }        },        //钩子函数，VUE对象初始化完成后自动执行        created() {            this.getAll();        },        methods: {            //列表            getAll() {                axios.get("/color/sandinglist").then((res) => {                    this.dataList =res.data.data;                    this.color1=this.dataList[0].color                    window.color1=this.color1;                })            },            //弹出添加窗口            handleCreate() {                this.dialogFormVisible = true;                this.resetForm();            },            //重置表单            resetForm() {                this.formData = {};            },            //添加            handleAdd() {                axios.post("/changpoint", this.formData).then((res) => {                    if (res.data.code == 20011) {                        this.dialogFormVisible = false;                        this.$message.success("添加成功")                    } else if (res.data.code == 20010) {                        this.$message.error("添加失敗")                    } else {                        this.$message.error(res.data.msg)                    }                }).finally(() => {                    this.getAll();                });            },            //弹出编辑窗口            handleUpdate(row) {                axios.get("/changpoint/" + row.id).then((res) => {                    if (res.data.code == 20041) {                        this.formData = res.data.data;                        this.dialogFormVisible4Edit = true;                    } else {                        this.$message.error(res.data.msg)                    }                })            },            //编辑            handleEdit() {                axios.put("/changpoint", this.formData).then((res) => {                    if (res.data.code == 20031) {                        this.dialogFormVisible4Edit = false;                        this.$message.success("修改成功")                    } else if (res.data.code == 20030) {                        this.$message.error("修改失敗")                    } else {                        this.$message.error(res.data.msg)                    }                }).finally(() => {                    this.getAll();                });            },            // 删除            handleDelete(row) {                this.$confirm("此操作将永久删除数据，是否继续", "提示", {type: 'info'}).then(() => {                    axios.delete("/changpoint/" + row.id).then((res) => {                        if (res.data.code == 20021) {                            this.$message.error("删除成功")                        } else {                            this.$message.error("删除失败")                        }                    }).finally(() => {                        this.getAll();                    });                }).catch(() => {                    this.$message.info("删除取消")                })            }        }    })</script></html>